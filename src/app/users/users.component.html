<div class="my-container" fxHide.lt-sm="true">
  <div class="calendar-selector" *ngIf="isOwnerOrHr()">
    <button class="arrow-button" mat-stroked-button mat-flat-button (click)="previous()">&#60;</button>
    <mat-form-field appearance="outline" class="month-select">
      <mat-select placeholder="Month" [formControl]="monthFormControl" name="month">
        <mat-option *ngFor="let monthNb of monthsNumbers" [value]="monthNb">
          {{months[monthNb]}}
        </mat-option>
      </mat-select>
    </mat-form-field>
    <button class="arrow-button" mat-stroked-button mat-flat-button (click)="next()">&#62;</button>
  </div>

  <div class="filters">
    <mat-form-field>
      <input matInput [(ngModel)]="filter" placeholder="Filter">
    </mat-form-field>
    <mat-checkbox [(ngModel)]="clockedAllFilter" *ngIf="isOwnerOrHr()">Clocking complete</mat-checkbox>
    <mat-checkbox [(ngModel)]="clockedPartiallyFilter" *ngIf="isOwnerOrHr()">Clocking incomplete</mat-checkbox>
    <mat-checkbox [(ngModel)]="myTeamFilter" *ngIf="isOwnerOrManager()">My team</mat-checkbox>
    <mat-checkbox [(ngModel)]="myManagerTeamFilter" *ngIf="hasManager()">My manager's team</mat-checkbox>
  </div>

  <table mat-table [dataSource]="dataSource" matSort>
    <ng-container matColumnDef="email">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Email</th>
      <td mat-cell *matCellDef="let user">
        <button mat-icon-button color="primary" [routerLink]="'/users/' + user.id">
          <mat-icon>person</mat-icon>
        </button>
        {{user.email}}
      </td>
    </ng-container>

    <ng-container matColumnDef="firstName">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
      <td mat-cell *matCellDef="let user">{{user.firstName}}</td>
    </ng-container>
    
    <ng-container matColumnDef="lastName">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Surname</th>
      <td mat-cell *matCellDef="let user">{{user.lastName}}</td>
    </ng-container>

    <ng-container matColumnDef="type">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Role</th>
      <td mat-cell *matCellDef="let user">{{user.type}}</td>
    </ng-container>

    <ng-container matColumnDef="freeDaysLeft">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Vacations</th>
      <td mat-cell *matCellDef="let user">{{user.freeDaysLeft}}</td>
    </ng-container>

    <ng-container matColumnDef="norm">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Norm</th>
      <td mat-cell *matCellDef="let user">{{user.norm}}</td>
    </ng-container>

    <ng-container matColumnDef="manager">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Manager email</th>
      <td mat-cell *matCellDef="let user">
        <button mat-icon-button color="primary" [routerLink]="'/users/' + user.managerId" *ngIf="getManagerEmail(user) !== ''">
          <mat-icon>person</mat-icon>
        </button>
        {{getManagerEmail(user)}}
      </td>
    </ng-container>

    <ng-container matColumnDef="clocking" *ngIf="isOwnerOrHr()">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Clocking</th>
      <td mat-cell *matCellDef="let user">
        <button mat-icon-button color="accent" [routerLink]="'/timesheet-records/' + user.id">
          <mat-icon>timer</mat-icon>
        </button>
        {{calculateWorkedHours(user) + calculateFreeDaysHours(user) + calculateLeaveRequestsHours(user)}}/{{calculateTotalHours(user)}}
      </td>
    </ng-container>
  
    <tr mat-header-row *matHeaderRowDef="displayedColumnsDesktop"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumnsDesktop;"></tr>
  </table>
</div>
